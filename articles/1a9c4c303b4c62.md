---
title: "ã€Flutterã€‘GoRouterã®Tips 5é¸"
emoji: "ğŸ’¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Flutter,GoRouter]
published: false
---

Navigator2.0ãŒå‡ºã¦ã‹ã‚‰ã—ã°ã‚‰ãçµŒã¡ã¾ã—ãŸãŒã€å¯¾å¿œã•ã‚Œã¦ã„ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ã¶ã£ã¡ã‚ƒã‘Webç‰ˆã‚’åˆ©ç”¨ã—ãªã‘ã‚Œã°ã€Navigator1.0ã®ã¾ã¾ã§ã‚‚å•é¡Œãªãã‚¢ãƒ—ãƒªã‚’çµ„ã‚€ã“ã¨ã¯å‡ºæ¥ã¾ã™ãŒã€
Webå¯¾å¿œã‚„ä»Šå¾Œã®ãŸã‚ã«å®£è¨€çš„ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®Navigator2.0ã®åˆ©ç”¨ãŒã©ã‚“ã©ã‚“å¢—ãˆã¦ã„ã‚‹å°è±¡ãŒã‚ã‚Šã¾ã™ã€‚

ä»Šå›ã¯Navigator2.0ã«å¯¾å¿œã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä¸­ã§ã‚‚
å…¬å¼å‚˜ä¸‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§äººæ°—ã®é«˜ã„`go_router`ã«ã¤ã„ã¦ã®Tipsã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã™ã€‚

## èµ·å‹•æ™‚ã®ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥è¡¨ç¤º

èµ·å‹•ä¸­ã¯ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã§ã€èµ·å‹•å¾Œã«å„ç”»é¢ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ãŸã„å ´åˆ

## ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æ¯ã®é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

é·ç§»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹éš›ã€`buildPage`ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆãŒã‚ã‚‹ãŒã€
ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚«ã‚¹ã‚¿ãƒ ã—ã‚ˆã†ã¨ã™ã‚‹ã¨iOSã§ã‚¹ãƒ©ã‚¤ãƒ‰ãƒãƒƒã‚¯ã§ããªã„ã€‚

ä¸‹è¨˜ã®ã‚ˆã†ã«ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¥ã«å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚‹

## go_routerã®ç”»é¢é·ç§»ã‚’ãƒ­ã‚°å‡ºåŠ›

### ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ› - ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã®ã¿ã‚’å‡ºåŠ›ã™ã‚‹ã®ã§ã‚ã‚Œã°ã€
ä¸‹è¨˜ã®ã‚ˆã†ã«`debugLogDiagnostics`ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§å¯¾å¿œå¯èƒ½ã§ã™ã€‚

```dart
GoRouter(
    // `debugLogDiagnostics`ã‚’æŒ‡å®šã™ã‚‹ã®ã¿ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹
	debugLogDiagnostics: true,
    routes: router.routes,
  );
```

ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã«ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

> [GoRouter] Full paths for routes:
>              => /
>              => /dashboard
>              => /item
> [GoRouter] redirecting to RouteMatchList(/dashboard)
> [GoRouter] going to /item

### å¤–éƒ¨å‡ºåŠ› - ä¾‹ï¼šFirebase Analytics

ãƒªãƒªãƒ¼ã‚¹å¾Œã®ã‚¢ãƒ—ãƒªã®åˆ†æã®éš›ã«ã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ç”»é¢ã‚’å¤šãåˆ©ç”¨ã—ã¦ã„ã‚‹ã‹ã‚’èª¿æŸ»ã™ã‚‹ãŸã‚ã€Firebase Analyticsãªã©ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚

ã“ã†ã„ã£ãŸå ´åˆã€ã‚¢ãƒ—ãƒªå†…ã§`ShellRoute`ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ã‹å¦ã‹ã§å¯¾å¿œæ–¹æ³•ã‚’å¤‰ãˆã‚‹å¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚

#### åˆ©ç”¨ã—ã¦ã„ãªã„å ´åˆ

`ShellRoute`ãªã©ã‚’åˆ©ç”¨ã—ã¦ã€ãƒã‚¹ãƒˆã—ã¦ã„ãªã„å ´åˆã€
ç”¨æ„ã•ã‚Œã¦ã„ã‚‹`observers`ã«é€šçŸ¥å‡¦ç†ã‚’è¿½åŠ ã™ã‚Œã°å•é¡Œãªãæ¤œçŸ¥ã—ã¦ãã‚Œã¾ã™ã€‚

```dart
GoRouter(
    routes: router.routes,
    // `observers`ã«æŒ‡å®š
    observers: [AnalyticsRouterObserver()],
  );
```

æŒ‡å®šã™ã‚‹Obeserverã¯`NavigatorObserver`ã‚’ç¶™æ‰¿ã™ã‚Œã°ã€ä¸‹è¨˜ã®ã‚ˆã†ã«å¥½ããªã‚ˆã†ã«è¨˜è¼‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
é·ç§»å‰ã®ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚å–å¾—ã§ãã‚‹ã®ã§ã€å°ç·šã‚‚ã‚ã‹ã‚Šã‚„ã™ãã¦ä½¿ã„å‹æ‰‹ãŒã‚ˆã„ã§ã™ã­

```dart
class AnalyticsRouterObserver extends NavigatorObserver {
  @override
  void didPush(
    Route<dynamic> route,
    Route<dynamic>? previousRoute,
  ) {
    analyticsService.routerEvent('didPush: $route');
  }

  @override
  void didPop(Route<dynamic> route, Route<dynamic>? previousRoute) {
    analyticsService.routerEvent('didPop: $route');
  }

  @override
  void didRemove(Route<dynamic> route, Route<dynamic>? previousRoute) {
    analyticsService.routerEvent('didRemove: $route');
  }

  @override
  void didReplace({Route<dynamic>? newRoute, Route<dynamic>? oldRoute}) {
    analyticsService.routerEvent('didReplace: $route');
  }
}
```



#### åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆ

`ShellRoute`ã‚’åˆ©ç”¨ã—ã¦ã€ãƒã‚¹ãƒˆã—ãŸãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’è¡Œã£ã¦ã„ã‚‹å ´åˆã€
`observers`ã«ã‚ˆã‚‹å‡¦ç†ãŒæ¤œçŸ¥ã•ã‚Œãªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

ãã®ãŸã‚ã€`observers`ã‚’åˆ©ç”¨ã›ãšã«è‡ªå‰ã§ç¾åœ¨ã®ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç›£è¦–ã—ç¶šã‘ã‚‹æ–¹æ³•ã§å¯¾å¿œã—ã¾ã™ã€‚



## NavigationBarã¨NavigationRailã‚’ç«¯æœ«ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦å¤‰æ›´ã—ãŸã„

ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨`adaptive_scaffold`ã®å†…å®¹ã ã‘ã©ã€‚ã€‚ã€‚ä¸€å¿œ
